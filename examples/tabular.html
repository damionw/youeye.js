<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>YouEyeJS Tabular Demo</title>
        <link rel="stylesheet" href="tabulator.css">
        <script type="application/javascript" language="javascript" src="youeye.js"></script>
        <script type="application/javascript" language="javascript" src="tabulator.js"></script>
    </head>

    <body onload="startup()" height=100% width=100%>
        <ui-configuration
            application_background="#fefefe"
            application_foreground="blue"
            highlight_background="#00a0fe"
            toolbar_height="40px"
            padding="4px"
        ></ui-configuration>

        <ui-frame
            orientation="vertical"
            height="200%"
            width="100"
            pad=true
        >
            Start it
            <div
                id="table"
                subscribe="fetch_data"
                listener="tabular_event"
            >
            </div>
        </ui-frame>
    </body>

    <script type="application/javascript">
        function tabular_event(topic, payload) {
            var div_element = document.getElementById("table");
            var tabulator = div_element._tabulator;
            tabulator.replaceData(payload);
        }

        function startup() {
            var div_element = document.getElementById("table");
            var tabulator = div_element._tabulator;

            if (tabulator == null) {
                tabulator = div_element._tabulator= new Tabulator(
                    div_element, {
                        data: [], //assign data to table
                        layout:"fitDataStretch",
        //                 responsiveLayout: "collapse",
                        selectable: 1, //make 1 row selectable at a time

                        columns:[ //Define Table Columns
                            {title:"Name", field:"from"},
                            {title:"Phone", field:"phone", hozAlign:"left"}
                        ]
                    }
                );

                tabulator.on(
                    "rowSelected", // "rowSelectionChanged",

                    function(row){
                        self.emit("row_selected", row.getData());
                    }
                );
            }

            setTimeout(
                () => {
                    pubsubMessageRouter.singleton.emit(
                        "fetch_data",
                        [
                            {
                                "Name": "Me",
                                "Phone": "123-4567"
                            },
                            {
                                "Name": "You",
                                "Phone": "999-9999"
                            }
                        ]
                    );
                },

                2000
            );
        }
    </script>
</html>
